From f94b407ca995058adf82eeb4f273867b226c9f01 Mon Sep 17 00:00:00 2001
From: Yifan Gu <yifan.gu@coreos.com>
Date: Wed, 13 Jan 2016 14:44:30 -0800
Subject: [PATCH] sdjournal: Add 'Path' in config to let NewJournalReader()
 select journal dir.

---
 sdjournal/read.go | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

diff --git a/sdjournal/read.go b/sdjournal/read.go
index f20cff1..d90bf2f 100644
--- a/sdjournal/read.go
+++ b/sdjournal/read.go
@@ -37,6 +37,10 @@ type JournalReaderConfig struct {
 	// Show only journal entries whose fields match the supplied values. If
 	// the array is empty, entries will not be filtered.
 	Matches []Match
+
+	// If not empty, the journal instance will point to a journal residing
+	// in this directory. The supplied path may be relative or absolute.
+	Path string
 }
 
 // JournalReader is an io.ReadCloser which provides a simple interface for iterating through the
@@ -50,9 +54,14 @@ type JournalReader struct {
 func NewJournalReader(config JournalReaderConfig) (*JournalReader, error) {
 	r := &JournalReader{}
 
-	var err error
 	// Open the journal
-	if r.Journal, err = NewJournal(); err != nil {
+	var err error
+	if config.Path != "" {
+		r.Journal, err = NewJournalFromDir(config.Path)
+	} else {
+		r.Journal, err = NewJournal()
+	}
+	if err != nil {
 		return nil, err
 	}
 
